ifeq ($(CHILD),true)
ifneq ($(CHILD_TEST_READY),true)
CHILD_TEST_READY = true
.PHONY: child_test child_+test child__test child_~test
child_test: child__test child_~test
child_~test: | $(CHECK) child_~lint $(TEST_DEPS) $(TEST_TARGET) $(ACTION)/test
child_+test: | $(CHECK) child__test $(TEST_DEPS) $(TEST_TARGET) $(ACTION)/test
child__test:
	@touch -m $(DONE)/+test
	@$(call clear_cache,$(DONE)/_test)
	@$(call clear_cache,$(DONE)/test)
$(DONE)/_test/*: %
	@$(call clear_cache,$(DONE)/test)
	@$(call add_dep,test,$<)
	@$(call cache,$@)
endif
else
ifneq ($(TEST_READY),true)
TEST_READY = true
.PHONY: test +test _test ~test
test: _test ~test
~test: | $(CHECK) ~lint $(TEST_DEPS) $(TEST_TARGET) $(ACTION)/test
+test: | $(CHECK) _test $(TEST_DEPS) $(TEST_TARGET) $(ACTION)/test
_test:
	@touch -m $(DONE)/+test
	@$(call clear_cache,$(DONE)/_test)
	@$(call clear_cache,$(DONE)/test)
$(DONE)/_test/*: %
	@$(call clear_cache,$(DONE)/test)
	@$(call add_dep,test,$<)
	@$(call cache,$@)
endif
endif
